# –ü—Ä–∏–º–µ—Ä: –ê–≥–µ–Ω—Ç —Å MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –Ø–Ω–¥–µ–∫—Å –¢—Ä–µ–∫–µ—Ä–∞

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ MCP —Å–µ—Ä–≤–µ—Ä

–í –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
```bash
./gradlew :server:run
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:8080/mcp`

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–º–µ—Ä –∞–≥–µ–Ω—Ç–∞

–í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∏–ª–∏ –≤ IntelliJ IDEA:

**–°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ IntelliJ IDEA**
- –û—Ç–∫—Ä–æ–π—Ç–µ `composeApp/src/jvmMain/kotlin/org/example/demo/McpAgentExample.kt`
- –ü–ö–ú –Ω–∞ `main()` ‚Üí **Run 'McpAgentExampleKt.main()'**

**–°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª**
```bash
./gradlew :composeApp:run --args="mcp-agent"
```

## –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

1. ‚úÖ –ê–≥–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É MCP —Å–µ—Ä–≤–µ—Ä—É
2. ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (–≤–∫–ª—é—á–∞—è `yandex_tracker`)
3. ‚úÖ –í—ã–∑—ã–≤–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `yandex_tracker` —Å –¥–µ–π—Å—Ç–≤–∏–µ–º `count_open_tasks`
4. ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∑–∞–¥–∞—á –≤ –æ—á–µ—Ä–µ–¥–∏ 'TEST': 5"
5. ‚úÖ –í—ã–∑—ã–≤–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á
6. ‚úÖ –í—ã–∑—ã–≤–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–µ

## –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```
=== –ü–†–ò–ú–ï–†: –ê–ì–ï–ù–¢ –° MCP –ò–ù–°–¢–†–£–ú–ï–ù–¢–û–ú –Ø–ù–î–ï–ö–° –¢–†–ï–ö–ï–†–ê ===

1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É MCP —Å–µ—Ä–≤–µ—Ä—É...
   URL: http://localhost:8080/mcp
   
‚úì –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ MCP —Å–µ—Ä–≤–µ—Ä—É

2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤...
   –ù–∞–π–¥–µ–Ω–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤: 4
   - echo: Echoes back the input text
   - get_current_time: Returns the current server time
   - calculate: Performs basic arithmetic operations
   - yandex_tracker: –†–∞–±–æ—Ç–∞ —Å –∑–∞–¥–∞—á–∞–º–∏ –Ø–Ω–¥–µ–∫—Å –¢—Ä–µ–∫–µ—Ä–∞...

‚úì –ù–∞–π–¥–µ–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: yandex_tracker

3. –ê–≥–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç yandex_tracker...
   –î–µ–π—Å—Ç–≤–∏–µ: count_open_tasks

‚úì –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞:

   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∑–∞–¥–∞—á –≤ –æ—á–µ—Ä–µ–¥–∏ 'TEST': 5

4. –ê–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∑–∞–¥–∞—á...

‚úì –°–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∑–∞–¥–∞—á:

   –û—Ç–∫—Ä—ã—Ç—ã–µ –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥–∏ 'TEST':
   
   - TEST-1: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥ –≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - TEST-2: –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–∏—Å–∫–∞
   - TEST-4: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î
   - TEST-5: –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –º–æ–¥—É–ª—è –ø–ª–∞—Ç–µ–∂–µ–π
   - TEST-7: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD
   
   –í—Å–µ–≥–æ: 5 –∑–∞–¥–∞—á

5. –ê–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–¥–∞—á–µ TEST-1...

‚úì –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞—á–µ:

   –ó–∞–¥–∞—á–∞ TEST-1:
   –°—Ç–∞—Ç—É—Å: open
   –ù–∞–∑–≤–∞–Ω–∏–µ: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥ –≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   –û–ø–∏—Å–∞–Ω–∏–µ: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É

6. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç MCP —Å–µ—Ä–≤–µ—Ä–∞...
‚úì –û—Ç–∫–ª—é—á–µ–Ω
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ ChatViewModel:

```kotlin
// –í –º–µ—Ç–æ–¥–µ sendMessage() –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –≤—ã–∑–æ–≤–∞ MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
viewModelScope.launch {
    // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ –∑–∞–¥–∞—á–∞—Ö
    if (text.contains("–∑–∞–¥–∞—á", ignoreCase = true)) {
        val toolResult = callMcpTool(
            serverName = "local-server",
            toolName = "yandex_tracker",
            arguments = buildJsonObject {
                put("action", "count_open_tasks")
            }
        )
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è AI
        if (toolResult != null) {
            // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        }
    }
}
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤ UI:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ MCP —Å–µ—Ä–≤–µ—Ä
2. –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –∫–Ω–æ–ø–∫–∞ "MCP" ‚Üí "+ –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä"
3. –í–≤–µ–¥–∏—Ç–µ:
   - **–ò–º—è**: `Local Server`
   - **URL**: `http://localhost:8080/mcp`
4. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å"

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ curl

```bash
# 1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
curl -X POST http://localhost:8080/mcp \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "tools/list"
  }'

# 2. –í—ã–∑–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∑–∞–¥–∞—á
curl -X POST http://localhost:8080/mcp \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "id": 2,
    "method": "tools/call",
    "params": {
      "name": "yandex_tracker",
      "arguments": {
        "action": "count_open_tasks",
        "queue": "TEST"
      }
    }
  }'
```

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π:

1. –û–±–Ω–æ–≤–∏—Ç–µ `handleToolCall()` –≤ `McpServer.kt`
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤ enum –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
3. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É API:

–ó–∞–º–µ–Ω–∏—Ç–µ –º–æ–∫ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö `getOpenTasks()`, `countOpenTasks()`, `getTaskById()` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ API –Ø–Ω–¥–µ–∫—Å –¢—Ä–µ–∫–µ—Ä–∞.

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ –ê–≥–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç  
‚úÖ –ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∑–∞–¥–∞—á)  
‚úÖ –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é  

üéâ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!**

